<%= f.error_messages %>

<p>
  <%= f.label :title %><br />
  <%= f.text_field :title,:size=>80 %>
</p>
<p>
  <%= f.label :description %> (this will be WYSIWG soon)<br />
  <%= f.text_area :description, :cols=>70,:rows => 6 %>
</p>
<p>
  <%= f.label :notes %> (this will be WYSIWG soon)<br />
  <%= f.text_area :notes, :cols=>70,:rows => 6 %>
</p>
<p>
  Is a requirement of: 
  <%= f.select(:parent_id, current_user.weals.reject {|w| w.id == @weal.id}.collect {|w| [ w.title, w.id ] }, :include_blank => '-none-')%>
<p>
<% case @phase
  when :intention %>

<%if @weal.matched? %>
  <p>
    I am holding this intention as:  <%=  @holding_as %>
  </p>
  <p>
    The <%= @other_holding_as %> is:  <%= @other_party.full_name %>
  </p>
<% else %>
  <p>
    I am holding this intention as:
    <% if @proposals.nil? || @proposals.empty? %>
      <%= radio_button_tag('as', 'requester', checked = @weal.requester == current_user || @weal.new_record?) %> requester
      <%= radio_button_tag('as', 'offerer', checked = @weal.offerer == current_user) %> offerer
    <%else%>
      <%=  @holding_as %>
    <% end %>
  </p>
<%end%>
<% when :action %>
<p>Requester: <%= @weal.requester.full_name%></p>
<p>Offerer: <%= @weal.offerer.full_name%></p>

<% when :weals 
  users = User.find(:all)%>
<p>
  <%= f.label :requester_id %><br />
  <%= f.select(:requester_id, users.collect {|p| [ p.full_name, p.id ] }, {:include_blank => '-'})%>
</p>
<p>
  <%= f.label :offerer_id %><br />
  <%= f.select(:offerer_id, users.collect {|p| [ p.full_name, p.id ] }, {:include_blank => '-'})%>
</p>
<% end %>
<p>
  Wealth generated by this intention will be expressed in: <br />
  <table id="intention_currency_list">
    <tr><th>Currency</th><th>Type</th><th>Scope</th><th># accts</th><th>Description</th></tr>
  <% for currency in @current_circle.currencies 
    exists = @weal.currencies.exists?(currency.id)
    %>
      <tr>
        <td>
        <%= check_box_tag("currencies[#{currency.id}][used]",'1',exists) %> <%= hidden_field_tag("currencies[#{currency.id}][dummy]",'1')%>
        <%= render_currency_icon(currency) %>
        <%= h currency.name %>
        </td>
        <td><%= currency.humanized_type %></td>
        <td><%= currency.humanized_scope %></td>
        <td><%= currency.currency_accounts_total %></td>
        <td><%= h currency.description %></td>
      <tr>
  <% end %>
  </table>
</p>
<p>
  Tags: 
  <%= text_field_tag("tags",@weal.tag_list.join(', '),:size=>100) %>
<p>
